---
title: "Practica7AD"
format: html
editor: visual
---

```{r}
library(tidyverse)
library(factoextra)
```

```{r}
comercio = read_csv("data_comercio.csv")

comercio <- comercio %>%
  mutate(categoria = case_when(
    categoria == "Alimentos" ~ "A",
    categoria == "Electrónica" ~ "E",
    categoria == "Hogar" ~ "H",
    categoria == "Juguetes" ~ "J",
    categoria == "Ropa" ~ "R",
    TRUE ~ categoria  # Esta línea mantiene los valores actuales si hay otros no especificados
  ))

datos = comercio %>% select(importe_gastado, num_articulos) %>% scale()

fviz_nbclust(x = datos, FUNcluster = kmeans, method = "wss",
             diss = dist(datos, method = "euclidean")) +
  geom_vline(xintercept = 4, linetype = 2)


set.seed(2024)
km_clusters <- kmeans(x = datos, centers = 4, iter.max = 100, nstart = 100, algorithm = "Lloyd")





fviz_cluster(object = km_clusters, data = datos, show.clust.cent = TRUE)

fviz_cluster(object = km_clusters, data = datos, show.clust.cent = TRUE,
             star.plot = TRUE, repel = TRUE) +
  theme_bw() + theme(legend.position = "none")
```


